## 进程

> 并发执行的程序在执行过程中分配和管理资源的基本单位，是一个动态概念，竞争计算机系统资源的基本单位
>
> 描述了 CPU 在运行指令及加载和保存上下文所需的时间，放在应用上来说就代表了一个程序

## 线程
> 进程的一部分，一个没有线程的进程可以被看作是单线程的。又被称为轻权进程或轻量级进程，也是 CPU 调度的一个基本单位
>
> 描述了执行一段指令所需的时间

## 执行栈

> 可以把执行栈认为是一个存储函数调用的栈结构，遵循先进后出的原则

## 单线程模型

> 单线程模型，是指JS脚本只在一个线程上运行。JS同时只能执行一个任务，其他任务都必须等待。

但是JS脚本只在一个线程上执行，不代表JS引擎只有一个线程。事实上，JS引擎有多个线程，是一种主线程运行脚本，其他线程后台配合的模式

原因：
JavaScript的单线程，与它的用途有关。作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。比如，假定JavaScript同时有两个线程，一个线程在某个DOM节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？

为了利用多核CPU的计算能力，HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质。

## 事件循环 Event loop

> 主线程从"任务队列"中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为Event Loop（事件循环）

1. 整体的script(作为第一个宏任务)开始执行的时候，会把所有代码分为两部分：“同步任务”、“异步任务”；
2. 同步任务会直接进入主线程依次执行；
3. 异步任务会再分为宏任务和微任务；
4. 宏任务进入到Event Table中，并在里面注册回调函数，每当指定的事件完成时，Event Table会将这个函数移到Event Queue中；
5. 微任务也会进入到另一个Event Table中，并在里面注册回调函数，每当指定的事件完成时，Event Table会将这个函数移到Event Queue中；
6. 当主线程内的任务执行完毕，主线程为空时，会检查微任务的Event Queue，如果有任务，就全部执行，如果没有就执行下一个宏任务；
7. 上述过程会不断重复，这就是Event Loop事件循环；

## 宏任务、微任务

这里需要注意的是new Promise是会进入到主线程中立刻执行，而promise.then则属于微任务

- 宏任务(macro-task)，ES6规范称为task：
  - 整体代码script
  - setTimeOut
  - setInterval
  - setImmediate一类的定时事件
  - I/O 操作
  - UI 渲染
  - event listener
- 微任务(micro-task)，ES6规范称为jobs：
  - promise.then
  - process.nextTick(node)
  - Observer.observe
  - 对 Dom 变化监听的 MutationObserver